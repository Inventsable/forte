<template>
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1460 180">
    <g id="bg">
      <rect class="keyboard-bg" width="1460" height="180" />
    </g>
    <g id="piano">
      <g id="_21">
        <polygon
          class="keyboard-white"
          :style="styleKey(21)"
          points="32.41 116.5 32.41 175.5 6.57 175.5 6.57 116.5 6.58 116.5 6.58 4.5 28.27 4.5 28.27 116.5 32.41 116.5"
        />
      </g>
      <g id="_22">
        <rect :style="styleKey(22)" class="keyboard-black" x="30.28" y="4.5" width="12" height="110" />
      </g>
      <g id="_23">
        <polygon
          class="keyboard-white"
          :style="styleKey(23)"
          points="60.27 4.5 60.27 175.5 34.41 175.5 34.41 116.5 44.27 116.5 44.27 4.5 60.27 4.5"
        />
      </g>
      <g id="_24">
        <polygon
          class="keyboard-white"
          :style="styleKey(24)"
          points="80.08 116.5 88.44 116.5 88.44 175.5 62.58 175.5 62.58 4.5 80.08 4.5 80.08 116.5"
        />
      </g>
      <g id="_25">
        <rect class="keyboard-black" :style="styleKey(25)" x="82.08" y="4.5" width="12" height="110" />
      </g>
      <g id="_26">
        <polygon
          class="keyboard-white"
          :style="styleKey(26)"
          points="116.53 175.46 90.67 175.53 90.5 116.5 96.08 116.5 96.08 4.51 112.58 4.46 112.58 116.5 116.36 116.5 116.53 175.46"
        />
      </g>
      <g id="_27">
        <rect class="keyboard-black" :style="styleKey(27)" x="114.58" y="4.5" width="12" height="110" />
      </g>
      <g id="_28">
        <polygon
          class="keyboard-white"
          :style="styleKey(28)"
          points="144.15 4.5 144.15 175.5 118.28 175.5 118.28 116.5 128.57 116.5 128.57 4.5 144.15 4.5"
        />
      </g>
      <g id="_29">
        <polygon
          class="keyboard-white"
          :style="styleKey(29)"
          points="172 116.5 172 175.5 146.15 175.5 146.15 4.5 161.07 4.5 161.07 116.5 172 116.5"
        />
      </g>
      <g id="_30">
        <rect class="keyboard-black" :style="styleKey(30)" x="163.08" y="4.5" width="12" height="110" />
      </g>
      <g id="_31">
        <polygon
          class="keyboard-white"
          :style="styleKey(31)"
          points="199.87 116.5 199.87 175.5 174 175.5 174 116.5 177.07 116.5 177.07 4.5 193.57 4.5 193.57 116.5 199.87 116.5"
        />
      </g>
      <g id="_32">
        <rect class="keyboard-black" :style="styleKey(32)" x="195.58" y="4.5" width="12" height="110" />
      </g>
      <g id="_33">
        <polygon
          class="keyboard-white"
          :style="styleKey(33)"
          points="227.72 116.5 227.72 175.5 201.87 175.5 201.87 116.5 209.57 116.5 209.57 4.5 223.57 4.5 223.57 116.5 227.72 116.5"
        />
      </g>
      <g id="_34">
        <rect class="keyboard-black" :style="styleKey(34)" x="225.58" y="4.5" width="12" height="110" />
      </g>
      <g id="_35">
        <polygon
          class="keyboard-white"
          :style="styleKey(35)"
          points="255.57 4.5 255.57 175.5 229.72 175.5 229.72 116.5 239.57 116.5 239.57 4.5 255.57 4.5"
        />
      </g>
      <g id="_36">
        <polygon
          class="keyboard-white"
          :style="styleKey(36)"
          points="275.07 116.5 283.44 116.5 283.44 175.5 257.57 175.5 257.57 4.5 275.07 4.5 275.07 116.5"
        />
      </g>
      <g id="_37">
        <rect class="keyboard-black" :style="styleKey(37)" x="277.08" y="4.5" width="12" height="110" />
      </g>
      <g id="_38">
        <polygon
          class="keyboard-white"
          :style="styleKey(38)"
          points="311.52 175.46 285.68 175.53 285.5 116.5 291.07 116.5 291.07 4.51 307.57 4.46 307.57 116.5 311.36 116.5 311.52 175.46"
        />
      </g>
      <g id="_39">
        <rect class="keyboard-black" :style="styleKey(39)" x="309.58" y="4.5" width="12" height="110" />
      </g>
      <g id="_40">
        <polygon
          class="keyboard-white"
          :style="styleKey(40)"
          points="339.14 4.5 339.14 175.5 313.29 175.5 313.29 116.5 323.57 116.5 323.57 4.5 339.14 4.5"
        />
      </g>
      <g id="_41">
        <polygon
          class="keyboard-white"
          :style="styleKey(41)"
          points="367 116.5 367 175.5 341.14 175.5 341.14 4.5 356.07 4.5 356.07 116.5 367 116.5"
        />
      </g>
      <g id="_42">
        <rect class="keyboard-black" :style="styleKey(42)" x="358.08" y="4.5" width="12" height="110" />
      </g>
      <g id="_43">
        <polygon
          class="keyboard-white"
          :style="styleKey(43)"
          points="394.87 116.5 394.87 175.5 369 175.5 369 116.5 372.07 116.5 372.07 4.5 388.57 4.5 388.57 116.5 394.87 116.5"
        />
      </g>
      <g id="_44">
        <rect class="keyboard-black" :style="styleKey(44)" x="390.58" y="4.5" width="12" height="110" />
      </g>
      <g id="_45">
        <polygon
          class="keyboard-white"
          :style="styleKey(45)"
          points="422.71 116.5 422.71 175.5 396.87 175.5 396.87 116.5 404.57 116.5 404.57 4.5 418.57 4.5 418.57 116.5 422.71 116.5"
        />
      </g>
      <g id="_46">
        <rect class="keyboard-black" :style="styleKey(46)" x="420.58" y="4.5" width="12" height="110" />
      </g>
      <g id="_47">
        <polygon
          class="keyboard-white"
          :style="styleKey(47)"
          points="450.57 4.5 450.57 175.5 424.71 175.5 424.71 116.5 434.57 116.5 434.57 4.5 450.57 4.5"
        />
      </g>
      <g id="_48">
        <polygon
          class="keyboard-white"
          :style="styleKey(48)"
          points="470.07 116.5 478.44 116.5 478.44 175.5 452.57 175.5 452.57 4.5 470.07 4.5 470.07 116.5"
        />
      </g>
      <g id="_49">
        <rect class="keyboard-black" :style="styleKey(49)" x="472.08" y="4.5" width="12" height="110" />
      </g>
      <g id="_50">
        <polygon
          class="keyboard-white"
          :style="styleKey(50)"
          points="506.52 175.46 480.68 175.53 480.5 116.5 486.07 116.5 486.07 4.51 502.57 4.46 502.57 116.5 506.36 116.5 506.52 175.46"
        />
      </g>
      <g id="_51">
        <rect class="keyboard-black" :style="styleKey(51)" x="504.58" y="4.5" width="12" height="110" />
      </g>
      <g id="_52">
        <polygon
          class="keyboard-white"
          :style="styleKey(52)"
          points="534.14 4.5 534.14 175.5 508.29 175.5 508.29 116.5 518.58 116.5 518.58 4.5 534.14 4.5"
        />
      </g>
      <g id="_53">
        <polygon
          class="keyboard-white"
          :style="styleKey(53)"
          points="562 116.5 562 175.5 536.14 175.5 536.14 4.5 551.08 4.5 551.08 116.5 562 116.5"
        />
      </g>
      <g id="_54">
        <rect class="keyboard-black" :style="styleKey(54)" x="553.08" y="4.5" width="12" height="110" />
      </g>
      <g id="_55">
        <polygon
          class="keyboard-white"
          :style="styleKey(55)"
          points="589.87 116.5 589.87 175.5 564 175.5 564 116.5 567.08 116.5 567.08 4.5 583.58 4.5 583.58 116.5 589.87 116.5"
        />
      </g>
      <g id="_56">
        <rect class="keyboard-black" :style="styleKey(56)" x="585.58" y="4.5" width="12" height="110" />
      </g>
      <g id="_57">
        <polygon
          class="keyboard-white"
          :style="styleKey(57)"
          points="617.72 116.5 617.72 175.5 591.87 175.5 591.87 116.5 599.58 116.5 599.58 4.5 613.58 4.5 613.58 116.5 617.72 116.5"
        />
      </g>
      <g id="_58">
        <rect class="keyboard-black" :style="styleKey(58)" x="615.58" y="4.5" width="12" height="110" />
      </g>
      <g id="_59">
        <polygon
          class="keyboard-white"
          :style="styleKey(59)"
          points="645.58 4.5 645.58 175.5 619.72 175.5 619.72 116.5 629.58 116.5 629.58 4.5 645.58 4.5"
        />
      </g>
      <g id="_60">
        <polygon
          class="keyboard-white"
          :style="styleKey(60)"
          points="665.08 116.5 673.43 116.5 673.43 175.5 647.58 175.5 647.58 4.5 665.08 4.5 665.08 116.5"
        />
      </g>
      <g id="_61">
        <rect class="keyboard-black" :style="styleKey(61)" x="667.08" y="4.5" width="12" height="110" />
      </g>
      <g id="_62">
        <polygon
          class="keyboard-white"
          :style="styleKey(62)"
          points="701.52 175.46 675.67 175.53 675.5 116.5 681.08 116.5 681.08 4.51 697.58 4.46 697.58 116.5 701.36 116.5 701.52 175.46"
        />
      </g>
      <g id="_63">
        <rect class="keyboard-black" :style="styleKey(63)" x="699.58" y="4.5" width="12" height="110" />
      </g>
      <g id="_64">
        <polygon
          class="keyboard-white"
          :style="styleKey(64)"
          points="729.14 4.5 729.14 175.5 703.28 175.5 703.28 116.5 713.58 116.5 713.58 4.5 729.14 4.5"
        />
      </g>
      <g id="_65">
        <polygon
          class="keyboard-white"
          :style="styleKey(65)"
          points="757 116.5 757 175.5 731.14 175.5 731.14 4.5 746.08 4.5 746.08 116.5 757 116.5"
        />
      </g>
      <g id="_66">
        <rect class="keyboard-black" :style="styleKey(66)" x="748.08" y="4.5" width="12" height="110" />
      </g>
      <g id="_67">
        <polygon
          class="keyboard-white"
          :style="styleKey(67)"
          points="784.87 116.5 784.87 175.5 759 175.5 759 116.5 762.08 116.5 762.08 4.5 778.58 4.5 778.58 116.5 784.87 116.5"
        />
      </g>
      <g id="_68">
        <rect class="keyboard-black" :style="styleKey(68)" x="780.58" y="4.5" width="12" height="110" />
      </g>
      <g id="_69">
        <polygon
          class="keyboard-white"
          :style="styleKey(69)"
          points="812.72 116.5 812.72 175.5 786.87 175.5 786.87 116.5 794.58 116.5 794.58 4.5 808.58 4.5 808.58 116.5 812.72 116.5"
        />
      </g>
      <g id="_70">
        <rect class="keyboard-black" :style="styleKey(70)" x="810.58" y="4.5" width="12" height="110" />
      </g>
      <g id="_71">
        <polygon
          class="keyboard-white"
          :style="styleKey(71)"
          points="840.58 4.5 840.58 175.5 814.72 175.5 814.72 116.5 824.58 116.5 824.58 4.5 840.58 4.5"
        />
      </g>
      <g id="_72">
        <polygon
          class="keyboard-white"
          :style="styleKey(72)"
          points="860.08 116.5 868.43 116.5 868.43 175.5 842.58 175.5 842.58 4.5 860.08 4.5 860.08 116.5"
        />
      </g>
      <g id="_73">
        <rect class="keyboard-black" :style="styleKey(73)" x="862.08" y="4.5" width="12" height="110" />
      </g>
      <g id="_74">
        <polygon
          class="keyboard-white"
          :style="styleKey(74)"
          points="896.52 175.46 870.67 175.53 870.5 116.5 876.08 116.5 876.08 4.51 892.58 4.46 892.58 116.5 896.36 116.5 896.52 175.46"
        />
      </g>
      <g id="_75">
        <rect class="keyboard-black" :style="styleKey(75)" x="894.58" y="4.5" width="12" height="110" />
      </g>
      <g id="_76">
        <polygon
          class="keyboard-white"
          :style="styleKey(76)"
          points="924.14 4.5 924.14 175.5 898.28 175.5 898.28 116.5 908.58 116.5 908.58 4.5 924.14 4.5"
        />
      </g>
      <g id="_77">
        <polygon
          class="keyboard-white"
          :style="styleKey(77)"
          points="952 116.5 952 175.5 926.14 175.5 926.14 4.5 941.08 4.5 941.08 116.5 952 116.5"
        />
      </g>
      <g id="_78">
        <rect class="keyboard-black" :style="styleKey(78)" x="943.08" y="4.5" width="12" height="110" />
      </g>
      <g id="_79">
        <polygon
          class="keyboard-white"
          :style="styleKey(79)"
          points="979.87 116.5 979.87 175.5 954 175.5 954 116.5 957.08 116.5 957.08 4.5 973.58 4.5 973.58 116.5 979.87 116.5"
        />
      </g>
      <g id="_80">
        <rect class="keyboard-black" :style="styleKey(80)" x="975.58" y="4.5" width="12" height="110" />
      </g>
      <g id="_81">
        <polygon
          class="keyboard-white"
          :style="styleKey(81)"
          points="1007.72 116.5 1007.72 175.5 981.87 175.5 981.87 116.5 989.58 116.5 989.58 4.5 1003.58 4.5 1003.58 116.5 1007.72 116.5"
        />
      </g>
      <g id="_82">
        <rect class="keyboard-black" :style="styleKey(82)" x="1005.58" y="4.5" width="12" height="110" />
      </g>
      <g id="_83">
        <polygon
          class="keyboard-white"
          :style="styleKey(83)"
          points="1035.58 4.5 1035.58 175.5 1009.72 175.5 1009.72 116.5 1019.58 116.5 1019.58 4.5 1035.58 4.5"
        />
      </g>
      <g id="_84">
        <polygon
          class="keyboard-white"
          :style="styleKey(84)"
          points="1055.08 116.5 1063.43 116.5 1063.43 175.5 1037.58 175.5 1037.58 4.5 1055.08 4.5 1055.08 116.5"
        />
      </g>
      <g id="_85">
        <rect class="keyboard-black" :style="styleKey(85)" x="1057.08" y="4.5" width="12" height="110" />
      </g>
      <g id="_86">
        <polygon
          class="keyboard-white"
          :style="styleKey(86)"
          points="1091.53 175.46 1065.67 175.53 1065.51 116.5 1071.08 116.5 1071.08 4.51 1087.58 4.46 1087.58 116.5 1091.36 116.5 1091.53 175.46"
        />
      </g>
      <g id="_87">
        <rect class="keyboard-black" :style="styleKey(87)" x="1089.58" y="4.5" width="12" height="110" />
      </g>
      <g id="_88">
        <polygon
          class="keyboard-white"
          :style="styleKey(88)"
          points="1119.14 4.5 1119.14 175.5 1093.29 175.5 1093.29 116.5 1103.58 116.5 1103.58 4.5 1119.14 4.5"
        />
      </g>
      <g id="_89">
        <polygon
          class="keyboard-white"
          :style="styleKey(89)"
          points="1147.01 116.5 1147.01 175.5 1121.14 175.5 1121.14 4.5 1136.08 4.5 1136.08 116.5 1147.01 116.5"
        />
      </g>
      <g id="_90">
        <rect class="keyboard-black" :style="styleKey(90)" x="1138.08" y="4.5" width="12" height="110" />
      </g>
      <g id="_91">
        <polygon
          class="keyboard-white"
          :style="styleKey(91)"
          points="1174.87 116.5 1174.87 175.5 1149.01 175.5 1149.01 116.5 1152.08 116.5 1152.08 4.5 1168.58 4.5 1168.58 116.5 1174.87 116.5"
        />
      </g>
      <g id="_92">
        <rect class="keyboard-black" :style="styleKey(92)" x="1170.58" y="4.5" width="12" height="110" />
      </g>
      <g id="_93">
        <polygon
          class="keyboard-white"
          :style="styleKey(93)"
          points="1202.71 116.5 1202.71 175.5 1176.87 175.5 1176.87 116.5 1184.58 116.5 1184.58 4.5 1198.58 4.5 1198.58 116.5 1202.71 116.5"
        />
      </g>
      <g id="_94">
        <rect class="keyboard-black" :style="styleKey(94)" x="1200.58" y="4.5" width="12" height="110" />
      </g>
      <g id="_95">
        <polygon
          class="keyboard-white"
          :style="styleKey(95)"
          points="1230.58 4.5 1230.58 175.5 1204.71 175.5 1204.71 116.5 1214.58 116.5 1214.58 4.5 1230.58 4.5"
        />
      </g>
      <g id="_96">
        <polygon
          class="keyboard-white"
          :style="styleKey(96)"
          points="1250.08 116.5 1258.43 116.5 1258.43 175.5 1232.58 175.5 1232.58 4.5 1250.08 4.5 1250.08 116.5"
        />
      </g>
      <g id="_97">
        <rect class="keyboard-black" :style="styleKey(97)" x="1252.08" y="4.5" width="12" height="110" />
      </g>
      <g id="_98">
        <polygon
          class="keyboard-white"
          :style="styleKey(98)"
          points="1286.53 175.46 1260.67 175.53 1260.51 116.5 1266.08 116.5 1266.08 4.51 1282.58 4.46 1282.58 116.5 1286.36 116.5 1286.53 175.46"
        />
      </g>
      <g id="_99">
        <rect class="keyboard-black" :style="styleKey(99)" x="1284.58" y="4.5" width="12" height="110" />
      </g>
      <g id="_100">
        <polygon
          class="keyboard-white"
          :style="styleKey(100)"
          points="1314.14 4.5 1314.14 175.5 1288.29 175.5 1288.29 116.5 1298.58 116.5 1298.58 4.5 1314.14 4.5"
        />
      </g>
      <g id="_101">
        <polygon
          class="keyboard-white"
          :style="styleKey(101)"
          points="1342.01 116.5 1342.01 175.5 1316.14 175.5 1316.14 4.5 1331.08 4.5 1331.08 116.5 1342.01 116.5"
        />
      </g>
      <g id="_102">
        <rect class="keyboard-black" :style="styleKey(102)" x="1333.08" y="4.5" width="12" height="110" />
      </g>
      <g id="_103">
        <polygon
          class="keyboard-white"
          :style="styleKey(103)"
          points="1369.87 116.5 1369.87 175.5 1344.01 175.5 1344.01 116.5 1347.08 116.5 1347.08 4.5 1363.58 4.5 1363.58 116.5 1369.87 116.5"
        />
      </g>
      <g id="_104">
        <rect class="keyboard-black" :style="styleKey(104)" x="1365.58" y="4.5" width="12" height="110" />
      </g>
      <g id="_105">
        <polygon
          class="keyboard-white"
          :style="styleKey(105)"
          points="1397.71 116.5 1397.71 175.5 1371.87 175.5 1371.87 116.5 1379.58 116.5 1379.58 4.5 1393.58 4.5 1393.58 116.5 1397.71 116.5"
        />
      </g>
      <g id="_106">
        <rect class="keyboard-black" :style="styleKey(106)" x="1395.58" y="4.5" width="12" height="110" />
      </g>
      <g id="_107">
        <polygon
          class="keyboard-white"
          :style="styleKey(107)"
          points="1425.58 4.5 1425.58 175.5 1399.71 175.5 1399.71 116.5 1409.58 116.5 1409.58 4.5 1425.58 4.5"
        />
      </g>
      <g id="_108">
        <rect class="keyboard-white" :style="styleKey(108)" x="1427.58" y="4.5" width="25.86" height="171" />
      </g>
    </g>
  </svg>
</template>

<script>
export default {
  data: () => ({
    keys: [],
    blackKeys: [],
    isMounted: false
  }),
  mounted() {
    this.buildBlackKeys();
    this.buildKeys();
    this.isMounted = true;
  },
  methods: {
    buildBlackKeys() {
      let results = [1];
      let modifiers = [1, 3, 6, 8, 10];
      for (var i = 0; i < 7; i++) {
        let baseKey = i * 12 + 3;
        let octave = modifiers.map(key => {
          return baseKey + key;
        });
        results = [].concat(results, octave);
      }
      this.blackKeys = results;
    },
    buildKeys() {
      this.keys = [];
      console.log("Building keys");
      for (var i = 0; i < 88; i++) {
        let key = {
          index: i,
          state: false,
          velocity: 0,
          isBlack: this.blackKeys.includes(i)
        };
        this.keys.push(key);
      }
      console.log("Key creation complete");
      console.log(this.keys);
    },
    styleKey(number) {
      if (!this.isMounted) {
        return `fill: var(--color-scrollbar-arrow);`
      } else {
        let key = this.keys[number - 21];
        let style = `
          fill: var(--color-${
            key.state
              ? "default"
              : key.isBlack
              ? "scrollbar-thumb"
              : "scrollbar-arrow"
          });
        `;
        return style;
      }
    },
    setKey(args) {
      let key = this.keys[args[1] - 21]
      key.state = args[0] == 144;
      key.velocity = args[2];
    },
    resetKey(args) {
      let key = this.keys[args[1] - 21]
      key.state = false;
      key.velocity = 0;
    }
  }
};
</script>

<style>
svg {
  width: 100%;
  max-height: 90px;
  min-height: 60px;
}

.keyboard-bg {
  fill: var(--color-bg);
}
.keyboard-white {
  fill: #727272;
}
.keyboard-black {
  fill: #3f3f3f;
}
</style>
